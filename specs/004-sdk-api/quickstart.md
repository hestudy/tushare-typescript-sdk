# Quick Start Guide: SDK 文档站测试验证

**Feature**: 004-sdk-api
**Date**: 2025-09-30
**Purpose**: 验证文档站核心功能的快速开始指南

## 概述

本指南用于验证 SDK 文档站的所有核心功能是否正常工作。按照以下步骤依次执行,确保每个功能都能正确运行。

---

## 前置条件

### 环境要求
- Node.js 20.x+
- npm 或 pnpm
- 现代浏览器(Chrome 90+, Firefox 88+, Safari 14+)

### 准备工作
1. 已完成所有实现任务
2. 已构建 SDK 的浏览器版本(IIFE 格式)
3. 已生成 API 文档
4. 已安装所有依赖

---

## 步骤 1: 安装依赖

```bash
# 在项目根目录执行
npm install

# 或使用 pnpm
pnpm install
```

**验证**:
- ✅ 依赖安装成功,无错误

---

## 步骤 2: 构建 SDK 浏览器版本

```bash
# 构建 SDK(包括 IIFE 格式)
npm run build
```

**验证**:
- ✅ `dist/index.iife.js` 文件存在
- ✅ 文件大小合理(~15-60 KB,取决于是否压缩)
- ✅ 无构建错误

**检查命令**:
```bash
ls -lh dist/index.iife.js
```

---

## 步骤 3: 生成 API 文档

```bash
# 运行文档生成器
npm run docs:generate
```

**验证**:
- ✅ `docs/api/` 目录下生成了 Markdown 文件
- ✅ 至少生成了以下文件:
  - `docs/api/index.md` (索引页)
  - `docs/api/market/daily.md` (示例 API 文档)
- ✅ 文档包含 Frontmatter 元数据
- ✅ 无生成错误

**检查命令**:
```bash
ls -R docs/api/
head -20 docs/api/market/daily.md
```

---

## 步骤 4: 启动文档站开发服务器

```bash
# 启动 VitePress 开发服务器
npm run docs:dev
```

**验证**:
- ✅ 服务器成功启动
- ✅ 控制台显示访问 URL(如 `http://localhost:5173`)
- ✅ 无启动错误

**预期输出**:
```
  vitepress v1.6.4

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
```

---

## 步骤 5: 访问首页并验证导航

### 5.1 打开浏览器

在浏览器中访问: `http://localhost:5173`

### 5.2 验证首页

**检查项**:
- ✅ 页面正常加载,无 404 错误
- ✅ 显示项目标题: "Tushare TypeScript SDK"
- ✅ 显示主导航栏(指南、API 参考等)
- ✅ 样式正常,无明显布局错误

### 5.3 验证侧边栏导航

**检查项**:
- ✅ 左侧边栏显示 API 分类
- ✅ 分类包含: 行情数据、财务数据、基础数据等
- ✅ 分类可展开/折叠
- ✅ 点击分类项可跳转到对应页面

---

## 步骤 6: 验证 API 文档页面

### 6.1 选择一个 API

在侧边栏中选择 "行情数据" → "日线行情" (或任意其他 API)

### 6.2 验证文档内容

**检查项**:
- ✅ 页面标题正确(如 "日线行情")
- ✅ 显示功能描述
- ✅ 显示参数列表(参数名、类型、是否必填、说明)
- ✅ 显示返回值结构
- ✅ 显示代码示例
- ✅ 语法高亮正常

### 6.3 验证 API 测试面板

**检查项**:
- ✅ 页面下方显示 "测试接口" 面板
- ✅ 面板包含参数输入表单
- ✅ 必填参数带有 `*` 标记
- ✅ 输入框有 placeholder 或示例值

---

## 步骤 7: 配置 API Token

### 7.1 打开 Token 管理器

**位置**: 侧边栏顶部或页面顶部导航栏

**检查项**:
- ✅ 显示 Token 输入框
- ✅ 输入框为密码类型(或可切换显示/隐藏)
- ✅ 显示"保存"按钮

### 7.2 输入 Token

输入测试 token(从 Tushare 获取,或使用演示 token)

**检查项**:
- ✅ 输入后点击"保存",显示成功提示
- ✅ 刷新页面后,token 仍然保留(localStorage 持久化)

---

## 步骤 8: 测试一个 API 接口

### 8.1 填写参数

在 "日线行情" API 页面的测试面板中:

1. **输入参数**:
   - `ts_code`: `000001.SZ`
   - `trade_date`: `20250101` (或最近的交易日)

2. **点击"发送请求"按钮**

### 8.2 验证测试结果

**检查项**:
- ✅ 显示加载状态(loading spinner 或进度条)
- ✅ 请求完成后显示结果区域
- ✅ 结果区域包含:
  - HTTP 状态码(如 200)
  - 响应时间(如 "响应时间: 1234ms")
  - 格式化的 JSON 响应数据
- ✅ JSON 数据可展开/折叠
- ✅ JSON 语法高亮正常

### 8.3 验证错误处理(可选)

输入错误参数(如无效的 `ts_code`: `INVALID`),发送请求:

**检查项**:
- ✅ 显示错误信息
- ✅ 错误信息清晰(错误码 + 描述)
- ✅ 不会导致页面崩溃

---

## 步骤 9: 验证请求历史功能

### 9.1 打开请求历史

**位置**: 测试面板下方或侧边栏

**检查项**:
- ✅ 显示请求历史列表
- ✅ 列表包含刚才的测试请求
- ✅ 每条记录显示:
  - API 名称
  - 请求时间
  - 成功/失败状态
  - 响应摘要

### 9.2 重放请求

点击历史记录中的某条记录(或"重放"按钮)

**检查项**:
- ✅ 参数表单自动填充历史记录的参数值
- ✅ 可直接点击"发送请求"重新执行

### 9.3 清空历史

点击"清空历史"按钮

**检查项**:
- ✅ 显示确认对话框
- ✅ 确认后历史列表清空
- ✅ localStorage 中的历史数据也被清除

---

## 步骤 10: 验证搜索功能

### 10.1 打开搜索

**方式**: 点击搜索按钮或按快捷键(通常是 `/` 或 `Ctrl+K`)

**检查项**:
- ✅ 显示搜索弹窗
- ✅ 搜索框获得焦点

### 10.2 执行搜索

输入搜索关键词: `日线`

**检查项**:
- ✅ 实时显示搜索结果
- ✅ 结果包含 "日线行情" 相关页面
- ✅ 结果按相关度排序
- ✅ 点击结果可跳转到对应页面

### 10.3 测试中文搜索

输入中文关键词测试分词:
- `股票` → 应找到股票相关接口
- `财务` → 应找到财务数据相关接口

**检查项**:
- ✅ 中文搜索正常工作
- ✅ 模糊匹配有效(如输入 `日` 能匹配 `日线`)

---

## 步骤 11: 验证响应式布局(移动端)

### 11.1 切换到移动设备模式

在浏览器中打开开发者工具(F12),切换到设备模拟模式,选择移动设备(如 iPhone 14)

### 11.2 验证布局

**检查项**:
- ✅ 导航栏自动收缩为汉堡菜单
- ✅ 侧边栏在移动端可滑动显示/隐藏
- ✅ API 测试面板在移动端可正常使用
- ✅ 参数表单在小屏幕上布局合理
- ✅ 无横向滚动条(内容自适应)

---

## 步骤 12: 验证深色模式(可选)

### 12.1 切换主题

点击右上角的主题切换按钮(太阳/月亮图标)

### 12.2 验证深色模式

**检查项**:
- ✅ 整个页面切换为深色主题
- ✅ 代码块语法高亮在深色模式下可读
- ✅ API 测试面板在深色模式下样式正常
- ✅ JSON 结果展示在深色模式下可读

---

## 步骤 13: 验证浏览器兼容性(可选)

在以下浏览器中重复步骤 5-10:
- [ ] Chrome 90+
- [ ] Firefox 88+
- [ ] Safari 14+
- [ ] Edge 90+

**检查项**:
- ✅ 所有浏览器中功能正常
- ✅ 无 JavaScript 错误
- ✅ 样式一致(允许轻微差异)

---

## 步骤 14: 性能验证(可选)

### 14.1 Lighthouse 测试

在 Chrome 开发者工具中运行 Lighthouse:

**目标分数**:
- Performance: > 90
- Accessibility: > 90
- Best Practices: > 90
- SEO: > 90

### 14.2 加载时间测试

使用浏览器 Network 面板查看:

**目标指标**:
- 首屏加载时间: < 3s
- 文档加载完成: < 5s
- 总资源大小: < 500 KB (不含 SDK)

---

## 步骤 15: 清理和重置

### 15.1 清除 localStorage

在浏览器控制台执行:
```javascript
localStorage.clear()
location.reload()
```

**验证**:
- ✅ Token 配置被清除
- ✅ 请求历史被清除
- ✅ 页面重新加载后为初始状态

### 15.2 停止开发服务器

在终端中按 `Ctrl+C` 停止 VitePress 开发服务器

---

## 验收标准

所有以下核心功能必须通过验证:

| 功能 | 状态 |
|------|------|
| ✅ 文档站首页加载 | □ |
| ✅ API 分类导航显示 | □ |
| ✅ API 文档内容完整 | □ |
| ✅ Token 管理功能 | □ |
| ✅ API 接口测试成功 | □ |
| ✅ 测试结果正确显示 | □ |
| ✅ 请求历史记录 | □ |
| ✅ 历史重放功能 | □ |
| ✅ 搜索功能正常 | □ |
| ✅ 响应式布局(移动端) | □ |

---

## 常见问题排查

### 问题 1: 文档未生成

**可能原因**:
- TypeDoc 未正确配置
- 源代码中缺少 JSDoc 注释
- 分类配置错误

**解决方案**:
```bash
# 检查 TypeDoc 配置
cat typedoc.json

# 手动运行 TypeDoc
npx typedoc --help
```

### 问题 2: API 测试失败

**可能原因**:
- Token 未配置或无效
- CORS 问题
- Tushare API 服务不可用

**解决方案**:
```bash
# 检查浏览器控制台错误
# 验证 token 有效性
# 检查网络请求详情
```

### 问题 3: localStorage 不工作

**可能原因**:
- 浏览器隐私模式
- localStorage 被禁用
- 存储配额已满

**解决方案**:
```javascript
// 在控制台测试 localStorage
try {
  localStorage.setItem('test', 'test')
  localStorage.removeItem('test')
  console.log('localStorage 可用')
} catch (e) {
  console.error('localStorage 不可用:', e)
}
```

### 问题 4: 搜索无结果

**可能原因**:
- 索引未生成
- 搜索关键词不匹配
- 中文分词问题

**解决方案**:
- 重新构建文档站
- 检查 VitePress 搜索配置
- 尝试不同的搜索关键词

---

## 下一步

验证完成后:

1. **记录问题**: 如发现任何问题,在 GitHub Issues 中创建 bug 报告
2. **性能优化**: 如性能指标未达标,进行针对性优化
3. **用户测试**: 邀请其他开发者测试,收集反馈
4. **文档完善**: 根据测试结果完善使用文档

---

**快速开始指南版本**: 1.0
**最后更新**: 2025-09-30
**预计验证时间**: 30-45 分钟